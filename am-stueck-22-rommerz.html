<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Funk√ºbung ‚Äì Station: Am St√ºck 22 (Rommerz)</title>
  <style>
    :root {
      --brand:#c62828; /* Feuerwehr-Rot */
      --ok:#2e7d32;
      --warn:#c62828;
      --bg:#f7f8fb;
      --card:#ffffff;
      --border:#e5e7ef;
      --text:#111;
      --muted:#555;
    }
    *{box-sizing:border-box}
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
      margin:0; padding:16px; line-height:1.5; background:var(--bg); color:var(--text);
    }
    .card{
      max-width:860px; margin:auto; background:var(--card);
      border:1px solid var(--border); border-radius:18px;
      box-shadow:0 1px 10px rgba(0,0,0,.06);
      overflow:hidden;
    }
    .header{
      display:flex; align-items:center; gap:12px;
      padding:16px 18px; border-bottom:1px solid var(--border);
      background:linear-gradient(180deg, rgba(198,40,40,.06), transparent);
    }
    .icon{ font-size:28px; line-height:1; filter: drop-shadow(0 1px 0 rgba(0,0,0,.15)); }
    h1{ margin:0; font-size:20px; letter-spacing:.2px; }
    .wrap{ padding:18px; }
    .status{
      padding:12px 14px; border-left:8px solid var(--warn);
      background:#fff; border:1px solid var(--border); border-radius:12px;
    }
    .status.ok{ border-left-color:var(--ok); }
    .status.warn{ border-left-color:var(--warn); }
    .btn{
      margin-top:12px; display:inline-block; font-size:1rem; font-weight:700;
      padding:.7rem 1.1rem; border-radius:12px; border:2px solid var(--warn);
      background:#fff; color:var(--warn); cursor:pointer; transition:all .15s ease;
    }
    .btn.danger{ background:#fff; color:var(--warn); border-color:var(--warn); }
    .btn.success{ background:var(--ok); color:#fff; border-color:var(--ok); }
    .btn:active{ transform:translateY(1px); }
    .task{ margin-top:18px; border:1px dashed var(--border); border-radius:12px; padding:14px; }
    .task h2{ margin:0 0 8px 0; font-size:1.05rem; color:var(--brand); text-decoration:underline; }
    details{ margin-top:16px; }
    summary{ cursor:pointer; font-weight:600; }
    .muted{ color:var(--muted); }
  </style>
</head>
<body>
  <div class="card">
    <div class="header">
      <div class="icon">üöí</div>
      <div>
        <h1>Funk√ºbung ‚Äì Station: Am St√ºck 22 (Rommerz)</h1>
      </div>
    </div>
    <div class="wrap">
      <div id="status" class="status warn" role="status" aria-live="polite">
        <strong>Status:</strong> Noch kein Standort gepr√ºft. Bitte auf <em>Standort pr√ºfen</em> tippen und GPS-Freigabe erlauben.
      </div>

      <button id="btn" class="btn danger" aria-pressed="false">Standort pr√ºfen</button>

      <div id="content" style="display:none">
        <div class="task">
          <h2>Hinweis &amp; Aufgabe</h2>
          <p><strong>Hinweis-Buchstabe:</strong> <span id="hint">‚Äî</span> <span class="muted">(wird durch die √úbungsleitung je Fahrzeug festgelegt)</span></p>
          <p><strong>Aufgabe:</strong> Wiederholt eine durchgesagte Zahl/UTM-Koordinate exakt und fehlerfrei.</p>
        </div>
      </div>

      <details>
        <summary>Info &amp; Konfiguration</summary>
        <p class="muted">
          <strong>Station:</strong> Am St√ºck 22 (Rommerz)<br>
          <strong>Koordinaten (WGS84):</strong> 50.450764, 9.614117<br>
          <strong>Radius:</strong> 60 m
        </p>
      </details>
    </div>
  </div>

<script>
const TARGET_LAT = 50.450764;
const TARGET_LNG = 9.614117;
const RADIUS_M   = 60;

function haversine(lat1, lon1, lat2, lon2){
  const toRad = d => d * Math.PI / 180;
  const R = 6371000;
  const dLat = toRad(lat2 - lat1);
  const dLon = toRad(lon2 - lon1);
  const a = Math.sin(dLat/2)**2 + Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)**2;
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return R * c;
}

const statusBox = document.getElementById("status");
const btn = document.getElementById("btn");
const content = document.getElementById("content");

function setStatusOk(text){
  statusBox.classList.remove("warn"); statusBox.classList.add("ok");
  statusBox.innerHTML = `<strong>Status:</strong> ${text}`;
  btn.classList.remove("danger"); btn.classList.add("success");
}
function setStatusWarn(text){
  statusBox.classList.remove("ok"); statusBox.classList.add("warn");
  statusBox.innerHTML = `<strong>Status:</strong> ${text}`;
  btn.classList.remove("success"); btn.classList.add("danger");
}

btn.addEventListener("click", () => {
  if(!navigator.geolocation){
    setStatusWarn("Geolocation wird von diesem Ger√§t/Browser nicht unterst√ºtzt.");
    return;
  }
  setStatusWarn("Bitte Standortfreigabe erlauben ‚Ä¶");
  navigator.geolocation.getCurrentPosition(pos => {
    const {{ latitude, longitude, accuracy }} = pos.coords;
    const dist = haversine(latitude, longitude, TARGET_LAT, TARGET_LNG);
    if(dist <= RADIUS_M){
      setStatusOk(`Am richtigen Ort (‚âà ${{Math.round(dist)}} m, Genauigkeit ¬±${{Math.round(accuracy)}} m).`);
      content.style.display = "block";
    }else{
      setStatusWarn(`Nicht am richtigen Ort (Entfernung ‚âà ${{Math.round(dist)}} m, Zielradius ${{RADIUS_M}} m).`);
      content.style.display = "none";
    }
  }, err => {
    if(err.code === err.PERMISSION_DENIED){
      setStatusWarn("Standortfreigabe wurde abgelehnt. Ohne GPS kann die Aufgabe nicht freigeschaltet werden.");
    }else{
      setStatusWarn("Standort konnte nicht ermittelt werden. Versucht es erneut (Daten/GPS aktivieren).");
    }
  }, {{ enableHighAccuracy:true, timeout:12000, maximumAge:0 }});
});
</script>
</body>
</html>
