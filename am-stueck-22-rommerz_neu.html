<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FunkÃ¼bung â€“ Station: Am StÃ¼ck 22 (Rommerz)</title>
  <style>
    :root {
      --brand:#c62828;
      --ok:#2e7d32;
      --warn:#c62828;
      --bg:#f7f8fb;
      --card:#ffffff;
      --border:#e5e7ef;
      --text:#111;
      --muted:#555;
    }
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
      margin:0;padding:16px;line-height:1.5;background:var(--bg);color:var(--text);
    }
    .card{
      max-width:860px;margin:auto;background:var(--card);
      border:1px solid var(--border);border-radius:18px;
      box-shadow:0 1px 10px rgba(0,0,0,.06);
    }
    .header{display:flex;align-items:center;gap:10px;padding:16px;border-bottom:1px solid var(--border);}
    .icon{font-size:28px;}
    .status{padding:12px;border-left:8px solid var(--warn);border-radius:10px;margin-top:10px;}
    .status.ok{border-left-color:var(--ok);}
    .btn{margin-top:10px;padding:.7rem 1.2rem;font-weight:700;border-radius:10px;border:2px solid var(--warn);color:var(--warn);background:#fff;cursor:pointer;}
    .btn.success{background:var(--ok);color:#fff;border-color:var(--ok);}
    .task{margin-top:20px;border:1px dashed var(--border);padding:14px;border-radius:10px;}
    .task h2{text-decoration:underline;color:var(--brand);}
    .muted{color:var(--muted);}
  </style>
</head>
<body>
  <div class="card">
    <div class="header">
      <div class="icon">ðŸš’</div>
      <h1>FunkÃ¼bung â€“ Station: Am StÃ¼ck 22 (Rommerz)</h1>
    </div>
    <div class="wrap">
      <div id="status" class="status warn"><strong>Status:</strong> Noch kein Standort geprÃ¼ft.</div>
      <button id="btn" class="btn danger">Standort prÃ¼fen</button>

      <div id="content" style="display:none">
        <div class="task">
          <h2>Hinweis &amp; Aufgabe</h2>
          <p><strong>Hinweis-Buchstabe:</strong> <span id="hint">â€”</span> <span class="muted">(wird durch die Ãœbungsleitung festgelegt)</span></p>
          <p><strong>Aufgabe:</strong> Wiederholt eine durchgesagte Zahl/UTM-Koordinate exakt und fehlerfrei.</p>
        </div>
      </div>
      <details>
        <summary>Info &amp; Konfiguration</summary>
        <p class="muted"><strong>Koordinaten (WGS84):</strong> 50.450764, 9.614117<br><strong>Radius:</strong> 60 m</p>
      </details>
    </div>
  </div>

<script>
const TARGET_LAT = 50.450764;
const TARGET_LNG = 9.614117;
const RADIUS_M = 60;

function haversine(lat1, lon1, lat2, lon2){
  const toRad = d => d * Math.PI / 180;
  const R = 6371000;
  const dLat = toRad(lat2 - lat1);
  const dLon = toRad(lon2 - lon1);
  const a = Math.sin(dLat/2)**2 + Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)**2;
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return R * c;
}

const statusBox = document.getElementById("status");
const btn = document.getElementById("btn");
const content = document.getElementById("content");

function setStatusOk(text){
  statusBox.classList.remove("warn");
  statusBox.classList.add("ok");
  statusBox.innerHTML = `<strong>Status:</strong> ${text}`;
  btn.classList.add("success");
}
function setStatusWarn(text){
  statusBox.classList.remove("ok");
  statusBox.classList.add("warn");
  statusBox.innerHTML = `<strong>Status:</strong> ${text}`;
  btn.classList.remove("success");
}

btn.addEventListener("click", () => {
  if(!navigator.geolocation){
    setStatusWarn("Geolocation wird nicht unterstÃ¼tzt.");
    return;
  }
  setStatusWarn("Bitte Standortfreigabe erlauben â€¦");
  navigator.geolocation.getCurrentPosition(pos => {
    const { latitude, longitude, accuracy } = pos.coords;
    const dist = haversine(latitude, longitude, TARGET_LAT, TARGET_LNG);
    if(dist <= RADIUS_M){
      setStatusOk(`Am richtigen Ort (â‰ˆ ${Math.round(dist)} m, Genauigkeit Â±${Math.round(accuracy)} m).`);
      content.style.display = "block";
    } else {
      setStatusWarn(`Nicht am richtigen Ort (Entfernung â‰ˆ ${Math.round(dist)} m, Zielradius ${RADIUS_M} m).`);
      content.style.display = "none";
    }
  }, err => {
    setStatusWarn("Standort konnte nicht ermittelt werden oder Zugriff verweigert.");
  }, { enableHighAccuracy:true, timeout:10000, maximumAge:0 });
});
</script>
</body>
</html>
